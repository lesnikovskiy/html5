<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>File Upload</title>
	<script type="text/javascript">	
	var StringBuilder = {};
	(function() {
		var parse = function() {
			return 'File uploaded: '
				+ 'name '
				+ this.name
				+ '; type '
				+ this.type
				+ '; size '
				+ this.size;
		};
		StringBuilder.parse = parse;
	})(window);
	
	window.addEventListener('load', function() {
		document.querySelector('#fileToUpload').addEventListener('change', function(e) {
			var files = e.target.files;
			var image = files[0];
			
			var xhr = new XMLHttpRequest();
			var fd = new FormData();
			
			xhr.open('POST', '/uploadFile', true);
			xhr.onload = function(e) {
				var response = e.target.responseText;
				if (response) {
					var json = JSON.parse(response);
					if (!json) return;
					
					document.querySelector('#status').appendChild(document.createTextNode(StringBuilder.parse.call(json)));
				}
			};
			fd.append('image', image);
			xhr.send(fd);
		});
	}, true);
	</script>
</head>
<body>
		<label for="image">Image: <input type="file" name="image" id="fileToUpload" /></label>
		<p id="status"></p>
</body>
</html>